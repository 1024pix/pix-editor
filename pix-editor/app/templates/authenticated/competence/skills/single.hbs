<div class="skill-header {{this.skill.statusCSS}}">
  <div class="ui menu">
    <div class="ui left menu">
      {{#unless this.edition}}
        {{#if this.mayDuplicate}}
          <PixButton
            @triggerAction={{this.duplicateSkill}}
            @backgroundColor="transparent-light"
            @iconBefore="copy"
            @prefixIconBefore="fas"
          >
            Dupliquer vers
          </PixButton>
        {{/if}}
        <PixButtonLink
          @backgroundColor="transparent-light"
          @route="authenticated.competence.skills.list"
          @model={{array this.skill.tube.id this.skill.level}}
          class="button-link-with-icon"
        >
          <FaIcon
            @icon="code-branch"
            @prefix="fas"></FaIcon> Liste des versions (v{{this.skill.version}})
        </PixButtonLink>
        {{#if (or this.mayArchive this.mayObsolete)}}
          <BasicDropdown title="Actions" @renderInPlace={{true}} @class="icon ui dropdown " @horizontalPosition="left" as |dd|>
            <dd.Trigger>
              <PixButton
                @triggerAction={{this.nullFn}}
                @backgroundColor="transparent-light"
                @iconBefore="bolt"
                @prefixIconBefore="fas"
              >
                Actions
              </PixButton>
            </dd.Trigger>
            <dd.Content @class="dropdown-content dropdown-content-challenge slide-fade">
              {{#if this.mayArchive}}
                <PixButton
                  @triggerAction={{fn this.archiveSkill dd}}
                  @backgroundColor="transparent-light"
                  @iconBefore="box-archive"
                  @prefixIconBefore="fas"
                >
                  {{t 'competence.skills.archive'}}
                </PixButton>
              {{/if}}
              {{#if this.mayObsolete}}
                <PixButton
                  @triggerAction={{fn this.obsoleteSkill dd}}
                  @backgroundColor="transparent-light"
                  @iconBefore="trash"
                  @prefixIconBefore="fas"
                >
                  {{t 'competence.skills.obsolete'}}
                </PixButton>
              {{/if}}
            </dd.Content>
          </BasicDropdown>
        {{/if}}
      {{/unless}}
    </div>
    <div class="item header">
      {{this.skill.name}}
      <div class="ui circular label {{this.skill.statusCSS}}">{{this.skill.status}}</div>
    </div>
    <div class="ui right menu">
      {{#if this.maximized}}
        <PixIconButton
          @triggerAction={{this.minimize}}
          @icon="window-minimize"
          @iconPrefix="fas"
          @ariaLabel="Minimiser la fenêtre des acquis"/>
      {{else}}
        <PixIconButton
          @triggerAction={{this.maximize}}
          @icon="window-maximize"
          @iconPrefix="fas"
          @ariaLabel="Maximiser la fenêtre des acquis"/>
      {{/if}}
      <PixIconButton
        @triggerAction={{this.close}}
        @icon="rectangle-xmark"
        @iconPrefix="fas"
        @ariaLabel="Fermer la fenêtre des acquis"/>
    </div>
  </div>
</div>
<div class="skill-details">
  <div class="skill-data" {{scroll-top this.edition}}>
    <Form::Skill @skill={{this.skill}} @edition={{this.edition}} />
  </div>
  <div class="ui vertical compact labeled icon menu skill-menu">
    {{#if this.edition}}
      <PixButton
        @triggerAction={{this.save}}
        @backgroundColor="transparent-light"
        @iconBefore="floppy-disk"
        @prefixIconBefore="fas"
      >
        Enregistrer
      </PixButton>
      <PixButton
        @triggerAction={{this.cancelEdit}}
        @backgroundColor="transparent-light"
        @iconBefore="ban"
        @prefixIconBefore="fas"
      >
        Annuler
      </PixButton>
    {{else}}
      {{#if this.skill.productionPrototype}}
        <PixButtonLink
          @href={{this.previewPrototypeUrl}}
          target="_blank"
          rel="noopener noreferrer"
          @backgroundColor="transparent-light"
          class="button-link-with-icon"
        >
          <FaIcon
            @icon="eye"
            @prefix="fas"></FaIcon> Prévisualiser
        </PixButtonLink>
      {{/if}}
      {{#if this.mayEdit}}
        <PixButton
          @triggerAction={{this.edit}}
          @backgroundColor="transparent-light"
          @iconBefore="pen-to-square"
          @prefixIconBefore="fas"
        >
          Modifier
        </PixButton>
      {{/if}}
      {{#if this.mayAccessAirtable}}
        <PixButtonLink
          @href={{this.airtableUrl}}
          target="_blank"
          rel="noopener noreferrer"
          @backgroundColor="transparent-light"
          class="button-link-with-icon"
        >
          <FaIcon
            @icon="table-cells-large"
            @prefix="fas"></FaIcon> Airtable
        </PixButtonLink>
      {{/if}}
      {{#unless this.skill.isLive}}
        <PixButton
          @triggerAction={{this.displayChallenges}}
          @backgroundColor="transparent-light"
          @iconBefore="archive"
          @prefixIconBefore="fas"
        >
          Épreuves &gt;&gt;
        </PixButton>
      {{/unless}}
    {{/if}}
  </div>
</div>
<PopIn::SelectLocation
        @onChange={{this.duplicateToLocation}}
        @title={{concat "Destination de la copie de " this.skillName}}
        @selectTubeLevel={{true}}
        @tube={{this.skill.tube}}
        @level={{this.skill.level}}
        @selectEmptyLevels={{true}}
        @isSkillLocation={{true}}
        @close={{this.closeSelectLocation}}
        @showModal={{this.displaySelectLocation}}
/>
<PopIn::Changelog
  @onApprove={{this.approveChangelog}}
  @defaultValue={{this.changelogText}}
  @showModal={{this.displayChangeLog}}
/>
<PopIn::ConfirmLog
  @title={{t 'common.confirm-log.save'}}
  @onApprove={{this.saveSkillCallBack}}
  @defaultValue={{this.defaultSaveChangelog}}
  @inputId="changelog-message"
  @onDeny={{this.closeComfirmLogPopin}}
  @content={{t 'common.confirm-log.content'}}
  @label={{t 'common.confirm-log.label'}}
  @showModal={{this.displayConfirmLog}}
/>
{{outlet}}